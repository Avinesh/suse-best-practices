<?xml version="1.0" encoding="UTF-8"?>
<!--<?oxygen RNGSchema="http://www.oasis-open.org/docbook/xml/5.0/rng/docbook.rng" type="xml"?>-->
<!DOCTYPE article [
<!ENTITY % entity SYSTEM "entity-decl.ent">
%entity;
]>
<article xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude"
    xmlns:xlink="http://www.w3.org/1999/xlink" version="5.0" xml:id="art.sbp.geo.drbd" xml:lang="en">

    <info>
        <title>Migrating from KVM for IBM z Systems to KVM integrated with SUSE Linux Enterprise
            Server</title>
        <subtitle>For SAP HANA 2.0 Deployments on IBM Power Systems</subtitle>
        <!--<orgname>SUSE Best Practices</orgname>-->
        <productname>SUSE Linux Enterprise Server for System z</productname>
        <productnumber>12 SP2</productnumber>
        <!-- <productname>SUSE Linux Enterprise Server for System z</productname>-->
        <!-- <productnumber>12 SP2</productnumber>-->


        <author>
            <personname>
                <firstname>Mike</firstname>
                <surname>Friesenegger, Technology Strategist - Alliances and Integrated Systems,
                    SUSE</surname>
            </personname>
            <!--<personname>
                <firstname>Mike</firstname>
                <surname>Friesenegger</surname>
            </personname>
            <affiliation>
                <jobtitle>Technology Strategist - Alliances and Integrated Systems</jobtitle>
                <orgname>SUSE</orgname>
            </affiliation>-->
        </author>

        <date><?dbtimestamp format="B d, Y" ?></date>

        <abstract>
            <para>On March 7, 2017, IBM announced the end of support for KVM for IBM z Systems:
                ***add link***. Preceding the IBM announcement on March 1, 2017, SUSE announced full
                support for KVM in SUSE Linux Enterprise Server 12 SP2 for z Systems and LinuxONE:
                ***add link*** and continuing for future versions of SLES. </para>

            <para>Customers that are using or testing KVM for IBM z Systems may have been using the
                IBM Redbook <quote>Getting Started with KVM for IBM z Systems</quote> at <link
                    xlink:href=" http://www.redbooks.ibm.com/abstracts/sg248332.html?Open&amp;pdfbookmark"
                /> . This SUSE best practices document will cover topics important in migrating from
                KVM for IBM z Systems to KVM in SUSE Linux Enterprise Server.</para>



        </abstract>
    </info>


    <sect1 xml:id="sec.installing">
        <title>Installing SUSE Linux Enterprise for z Systems and LinuxONE as KVM Host</title>

        <para>Like KVM for IBM z Systems, KVM in SLES is supported when installed into an PR/SM
            LPAR. The <quote>Installation on IBM z Systems</quote> section <link
                xlink:href="https://www.suse.com/documentation/sles-12/book_sle_deployment/data/cha_zseries.html"
            /> of the SUSE Linux Enterprise Server Deployment Guide provides information regarding
            supported hardware and memory requirements for installing into an LPAR. The
                <quote>Overiew of an LPAR Installation</quote> section at <link
                xlink:href="https://www.suse.com/documentation/sles-12/book_sle_deployment/data/sec_zseries_prep.html#sec_prep_inst_types"
            /> reviews the preparation and initial steps in starting the SUSE Linux Enterprise
            Server Installation System. </para>

        <para>A suggested partitioning layout includes separating the storage of the KVM disk images
            from the operating system. Using the BTRFS filesystem for the operating system enables
            rollback capabilities when patching the system. The default location for the KVM disk
            images is <filename>/var/lib/libvirt/images/</filename>. It is recommended to use
            Logical Volume Manager with the XFS filesystem for KVM disk images.</para>

        <para>For the Software Selection in the installer, use the list below for the minimum and
            suggested additional patterns to be installed.</para>

        <para>Minimum Patterns:</para>
        <itemizedlist>
            <listitem>
                <para>Base System</para>
            </listitem>
            <listitem>
                <para>Minimal System (Appliances)</para>
            </listitem>
            <listitem>
                <para>Help and Support Documentation</para>
            </listitem>
            <listitem>
                <para>KVM Virtualization Host and tools</para>
            </listitem>
        </itemizedlist>

        <para>Suggested additional Patterns</para>
        <itemizedlist>
            <listitem>
                <para>GNOME Desktop Environment &amp; X Window System (needed for managing
                    virtual machines using a GUI)</para>
            </listitem>
        </itemizedlist>

        <para>Make sure to register and patch the KVM host either during the initial installation or
            after the installation is complete.</para>


    </sect1>

    <sect1 xml:id="sec.managing_kvm">
        <title>Managing KVM Instances</title>

        <bridgehead>Prerequisites</bridgehead>

        <itemizedlist>
            <listitem>
                <para>Go to the download page for SUSE Linux Enterprise Server 12 SP1 for POWER (see
                        <link xlink:href="https://download.suse.com/Download?buildid=ivKxefYE5gc~"
                    />) and download DVD1 of the SLES12 SP1 ppc64le installation media </para>
            </listitem>
            <listitem>
                <para>The system must be able to register externally to scc.suse.com <emphasis
                        role="strong">or</emphasis> internally to an SMT server</para>
            </listitem>
        </itemizedlist>

        <warning>
            <title>Attention</title>
            <para>This procedure has only been tested on new installations using the SLES12 SP1
                ppc64le installation media.</para>
        </warning>

        <bridgehead>Steps</bridgehead>

        <procedure>
            <step>
                <para>Install SLES12 SP1 ppc64le</para>
                <substeps>
                    <step>
                        <para>Skip the registration</para>
                    </step>
                    <step>
                        <para>Do not install any additional Add On Products</para>
                    </step>
                    <step>
                        <para><emphasis role="strong">Suggestion:</emphasis> Install the operating
                            system disk using the Btrfs filesystem (learn more about Btrfs here
                                <link
                                xlink:href="https://www.suse.com/documentation/sles-12/stor_admin/data/sec_filesystems_major_btrfs.html"
                            /></para>
                    </step>
                    <step>
                        <para>Install the following patterns</para>
                        <itemizedlist>
                            <listitem>
                                <para>Help and Support Documentation</para>
                            </listitem>
                            <listitem>
                                <para>Base System</para>
                            </listitem>
                            <listitem>
                                <para>Minimal System (Appliances)</para>
                            </listitem>
                        </itemizedlist>
                    </step>
                </substeps>
            </step>

            <step>
                <para>Review the knowledgebase article <emphasis role="italic">Migrating a SLES 12
                        SP1 for POWER LE system to SLES for SAP Applications for POWER LE 12
                        SP1</emphasis> (see <link
                        xlink:href="https://www.suse.com/support/kb/doc?id=7018295"/>and download
                    the latest migration package which is referenced in this article.</para>
            </step>
            <step>
                <para><emphasis role="strong">OPTIONAL:</emphasis> If you use Btrfs for the OS disk,
                    create a pre-snapshot in case you want to undo the migration:</para>

                <para>
                    <command># snapper create -t pre -p -d “before sles for sap”</command>
                </para>

                <important>
                    <para>Make note of the snapshot number after running this command</para>
                </important>
            </step>

            <step>
                <para>Install and run the migration script</para>
                <para>
                    <command># rpm -Uvh migrate-sles-to-sles4sap-*.noarch.rpm</command>
                </para>
                <para>
                    <command># Migrate_SLES_to_SLES-for-SAP-12.sh</command>
                </para>

                <itemizedlist>
                    <listitem>
                        <para>Answer ‘y’ to proceed with the next step in the migration</para>
                    </listitem>
                    <listitem>
                        <para>Answer ‘n’ if you would like to migrate and register using
                            scc.suse.com</para>
                        <itemizedlist>
                            <listitem>
                                <para>Enter your email address to register SLES for SAP Applications
                                    12 SP1 for Power Systems</para>
                            </listitem>
                            <listitem>
                                <para>Enter your activation code for SLES for SAP Applications 12
                                    SP1 for Power Systems</para>
                            </listitem>
                        </itemizedlist>
                    </listitem>
                    <listitem>
                        <para>
                            <emphasis role="strong">OR</emphasis>
                        </para>
                        <para>Answer ‘y’ if you would like to migrate and register using a local SMT
                            server</para>
                        <itemizedlist>
                            <listitem>
                                <para>Enter the https URL of the SMT server (example:
                                    https://mysmt.company.com)</para>
                            </listitem>
                        </itemizedlist>
                    </listitem>
                </itemizedlist>
            </step>
            <step>
                <para><emphasis role="strong">OPTIONAL:</emphasis> If you use for the OS disk,
                    create a post-snapshot in case you want to undo the migration</para>

                <para>
                    <command># snapper create -t post --pre-number &lt;# from step 3> -d “after
                        sles for sap”</command>
                </para>
            </step>
        </procedure>

    </sect1>

    <sect1 xml:id="sec.next">
        <title>Next Steps</title>

        <para>The product ID for the system is now SUSE Linux Enterprise Server for SAP Applications
            12 SP1 for IBM Power Systems. The system has also been registered which enables you to
            update the existing installed packages and install additional patterns and packages
            needed to install SAP HANA and make SAP HANA System Replication highly available.</para>

        <para>Please refer to the SAP ONE Support Launchpad at <link
                xlink:href="https://launchpad.support.sap.com/#/notes/2055470"/> for specific
            details.</para>

        <para>If this system is a test system and you would like to undo the migration to test the
            procedure again, use snapper to undo the changes. For detailed information, refer to the
            official documentation for SUSE Linux Enterprise Server 12 documentation at <link
                xlink:href="https://www.suse.com/documentation/sles-12/book_sle_admin/data/sec_snapper_auto.html"
            />. The steps below can be used as an initial guide to undo the changes.</para>

        <orderedlist>
            <listitem>
                <para>Enter <command># snapper list</command></para>
            </listitem>
            <listitem>
                <para>Make note of the numbers associated to the <quote>before sles for sap</quote>
                    and <quote>after sles for sap</quote> snapshots</para>
            </listitem>
            <listitem>
                <para>Enter <command># snapper undochange &lt;”before sles for sap”
                        number>..&lt;”after sles for sap” number></command></para>
            </listitem>
        </orderedlist>
    </sect1>

    <sect1 xml:id="sec.add_info">
        <title>Additional Information</title>

        <para>This document only applies to SUSE Linux Enterprise Server for SAP Applications 12 SP1
            for IBM Power. Installation media will be made available for SUSE Linux Enterprise
            Server for SAP Applications 12 SP2 for IBM Power after SAP has certified SAP HANA 2 for
            SUSE Linux Enterprise Server for SAP Applications 12 SP2 for IBM Power.</para>

        <para>The packages to setup a SMT server are included in the &sls; 12 SP1 or &sls;
            for SAP Applications 12 SP1 for IBM Power Systems repositories. Information about
            installing and configuring an SMT server can be found at <link
                xlink:href="https://www.suse.com/documentation/sles-12/book_smt/data/book_smt.html"
            />.</para>
    </sect1>

    <sect1 xml:id="sec.legal_notice">
        <title>Legal Notice</title>

        <para>Copyright &copy;2006– 2016 SUSE LLC and contributors. All rights reserved. </para>

        <para>Permission is granted to copy, distribute and/or modify this document under the terms
            of the GNU Free Documentation License, Version 1.2 or (at your option) version 1.3; with
            the Invariant Section being this copyright notice and license. A copy of the license
            version 1.2 is included in the section entitled <quote>GNU Free Documentation
                License</quote>.</para>

        <para>SUSE, the SUSE logo and YaST are registered trademarks of SUSE LLC in the United
            States and other countries. For SUSE trademarks, see <link
                xlink:href="http://www.suse.com/company/legal/"
                >http://www.suse.com/company/legal/</link>.</para>

        <para>Linux is a registered trademark of Linus Torvalds. All other names or trademarks
            mentioned in this document may be trademarks or registered trademarks of their
            respective owners.</para>

        <para>All information found in this document has been compiled with utmost attention to
            detail. However, this does not guarantee complete accuracy. Neither SUSE LLC, its
            affiliates, the authors, nor the translators shall be held liable for possible errors or
            the consequences thereof.</para>

    </sect1>



    <?pdfpagebreak style="suse2013" formatter="fop"?>



    <xi:include href="license-gfdl.xml"/>

</article>
